{% extends "structure.html" %}
{% block title %}File Uploader{% endblock title %}
{% block css %}
	@import url(https://fonts.googleapis.com/css?family=Open+Sans:700,300);
	body{
		background-color:rgba(12,115,148,1);
	}

	.frame{
		background-color:rgba(12,115,148,1);
	}

	.frame {
		position: absolute;
		top: 50%;
		left: 50%;
		width: 400px;
		height: 400px;
		margin-top: -200px;
		margin-left: -200px;
		border-radius: 10px;
		box-shadow: 4px 8px 16px 0 rgba(0, 0, 0, 0.1);
		overflow: hidden;
		background: linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));;
		background-color:#052c65;
		font-family: "Open Sans", Helvetica, sans-serif;
	}

	.center {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 300px;
		height: 260px;
		border-radius: 3px;
		box-shadow: 8px 10px 15px 0 rgba(0, 0, 0, 0.2);
		background: #fff;
		display: flex;
		align-items: center;
		justify-content: space-evenly;
		flex-direction: column;
	}

	.title {
		width: 100%;
		height: 50px;
		border-bottom: 1px solid #999;
		text-align: center;
	}

	h1 {
		font-size: 16px;
		font-weight: 300;
		color: #666;
	}

	.dropzone {
		width: 100px;
		height: 80px;
		border: 1px dashed #999;
		border-radius: 3px;
		text-align: center;
	}

	.upload-icon {
		margin: 25px 2px 2px 2px;
	}

	.upload-input {
		position: relative;
		top: -62px;
		left: 0;
		width: 100%;
		height: 100%;
		opacity: 0;
	}

	.btn {
		display: block;
		width: 140px;
		height: 40px;
		background: rgba(12,115,148,1);
		color: #fff;
		border-radius: 3px;
		border: 0;
		box-shadow: 0 3px 0 0 #dee2e6;
		transition: all 0.3s ease-in-out;
		font-size: 14px; 
	}

	.btn:hover {
		background: #052c65;
		box-shadow: 0 3px 0 0 #dee2e6;
	}
{% endblock css %}

{% block shiftsecond %}
{% if messages %}
        {% for message in messages %}
        <div {% if message.tags %} class="alert alert-{{ message.tags }} alert-dismissible fade show mt-2" {% endif %}  style="position: absolute; left: 38%;"role="alert">
        <strong>{{message}}</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    {% endif %}
<div class="frame">
	<div class="svg text-center pt-3">
		<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="#fff" class="bi bi-cloud-arrow-up-fill" viewBox="0 0 16 16">
			<path d="M8 2a5.53 5.53 0 0 0-3.594 1.342c-.766.66-1.321 1.52-1.464 2.383C1.266 6.095 0 7.555 0 9.318 0 11.366 1.708 13 3.781 13h8.906C14.502 13 16 11.57 16 9.773c0-1.636-1.242-2.969-2.834-3.194C12.923 3.999 10.69 2 8 2m2.354 5.146a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0z"/>
		  </svg>	
	</div>
	<div class="center">
		<div class="title">
			<h1>Upload Excel / CSV </h1>
		</div>
		<form method="POST" enctype="multipart/form-data" action="/submit_excel/">
			{% csrf_token %}
			<div class="dropzone">
				<img src="http://100dayscss.com/codepen/upload.svg" class="upload-icon" />
				<input required type="file" class="upload-input" name = "excelFile" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
			</div>

			<button type="submit" class="btn mt-3 " name="uploadbutton">Upload file</button>
		</form>
	</div>
</div>

{% endblock shiftsecond %}
{% block js %}
	document.addEventListener('DOMContentLoaded', function () {
	  // Get the file input element
	  var fileInput = document.querySelector('.upload-input');
  
	  // Add change event listener to the file input
	  fileInput.addEventListener('change', function () {
		// Check if any file is selected
		if (fileInput.files.length > 0) {
		  // Get the selected file
		  var selectedFile = fileInput.files[0];
  
		  // Allowed file types
		  var allowedTypes = [
			'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
			'application/vnd.ms-excel',
			'.csv'
		  ];
  
		  // Check if the selected file type is allowed
		  if (!allowedTypes.includes(selectedFile.type)) {
			// File type is not allowed, remove the file
			alert('Invalid file type. Please upload a CSV or Excel file.');
			fileInput.value = ''; // Clear the file input
		  }
		}
	  });
	});
	{% endblock js %}